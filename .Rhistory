plot(galls2011 ~ I(females+ runif(30)), data=d)
plot(galls2011 ~ I(natural.galls+ runif(30)), data=d)
plot(galls2011[d$females>0 & d$shrubdying2011==0] ~ natural.galls[d$females>0 & d$shrubdying2011==0], data=d)
plot(galls2011[d$shrubdying2011==0] ~ females[d$shrubdying2011==0], data=d)
cloud( galls2011 ~ natural.galls + females, data=d)
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='s', size=1, zlab='Number of galls', xlab='Previous year gall density',ylab='Number of females')
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='h', add=TRUE)
plot3d(d$galls2011[d$females>0 & d$shrubdying2011==0] ~ d$natural.galls[d$females>0 & d$shrubdying2011==0]
	+ d$females[d$females>0 & d$shrubdying2011==0], type='s', size=1, )
plot3d(d$galls2011[d$females>0 & d$shrubdying2011==0] ~ d$natural.galls[d$females>0 & d$shrubdying2011==0]
	+ d$females[d$females>0 & d$shrubdying2011==0], type='h', add=TRUE)
library(scatterplot3d)
install.packages('scatterplot3d')
library(scatterplot3d)
plot(galls2011 ~ I(females+ runif(30)), data=d)
library(ggplot2)
p
source("/Users/will/Documents/R/ggplot2/rnc_ggplot2_border_themes.r")
d = read.csv('/Users/will/Documents/DATA/2011 DATA/field/VAA map.csv')
source("/Users/will/Documents/R/ggplot2/rnc_ggplot2_border_themes.r")
p1 = ggplot(data = d, aes(x = females, y = females)) +
	geom_point(alpha = 1/3, position = 'jitter') +
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),
		panel.border = theme_border(c('left', 'bottom')))
print(p1)
p1 = ggplot(data = d, aes(x = females, y = females)) +#
	geom_point(alpha = 1/3, position = 'jitter') +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
print(p1)
# plot number of galls in spring 2011 ~ number of females introduced in summer 2010#
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(alpha = 1/3, position = 'jitter') +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
print(p1)
# plot number of galls in spring 2011 ~ number of females introduced in summer 2010#
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(alpha = 1/2, position = 'jitter') +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
print(p1)
# plot number of galls in spring 2011 ~ number of females introduced in summer 2010#
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'green', alpha = 1/3, position = 'jitter', ) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
print(p1)
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = 'jitter', ) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
print(p1)
# plot number of galls in spring 2011 ~ number of females introduced in summer 2010#
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = 'jitter', size = 2) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
print(p1)
# plot number of galls in spring 2011 ~ number of females introduced in summer 2010#
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = 'jitter', size = 20) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
print(p1)
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = 'jitter', size = 5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
print(p1)
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = 'jitter', size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
print(p1)
p1.smooth = p1 + stat_smooth(method = 'lm')
print(p1.smooth)
p1.smooth = p1 + stat_smooth(method = 'glm', family = 'Poisson')
print(p1.smooth)
p1.smooth = p1 + stat_smooth(method = 'glm', family = 'Poisson', formula = y ~ x)
print(p1.smooth)
p1.smooth = p1 + stat_smooth(method = 'glm', family = 'poisson', formula = y ~ x)
print(p1.smooth)
p1.smooth = p1 + stat_smooth(method = 'glm', family = 'poisson') #, formula = y ~ x)
print(p1.smooth)
p1.smooth = p1 + stat_smooth(method = 'glm', family = 'poisson')
print(p1)
print(p1.smooth)
p1.smooth.lm = p1 + stat_smooth(method = 'lm')
print(p1)
print(p1.smooth)
print(p1.smooth.lm)
p1.smooth.loess = p1 + stat_smooth(method = 'loess')
print(p1.smooth.loess)
print(p1.smooth.lm)
summary(lm(galls2011 ~ females, data=d))
summary(glm(galls2011 ~ females, data=d, family='poisson'))
print(p1.smooth.pois)
p1.smooth.pois = p1 + stat_smooth(method = 'glm', family = 'poisson')
print(p1.smooth.pois)
print(p1.smooth.loess)
p1.smooth.default = p1 + stat_smooth()
print(p1.smooth.default)
print(p1.smooth.loess)
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, various possibilities#
p1.smooth.lm = p1 + stat_smooth(method = 'lm')#
p1.smooth.pois = p1 + stat_smooth(method = 'glm', family = 'poisson')#
p1.smooth.loess = p1 + stat_smooth(method = 'loess')#
p1.smooth.default = p1 + stat_smooth()#
#
# display the plot#
print(p1.smooth.loess)
p1.smooth.rlm = p1 + stat_smooth(method = 'rlm')
print(p1.smooth.rlm)
p1.smooth.gam = p1 + stat_smooth(method = 'gam')
print(p1.smooth.gam)
p1.smooth.gam = p1 + stat_smooth(method = 'gam', formula = y ~ x)
print(p1.smooth.gam)
p1.smooth.gam = p1 + stat_smooth(method = 'gam', formula = y ~ poly(x, 3))
print(p1.smooth.gam)
print(p1.smooth.loess)
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = position_jitter(w = 0.1, h = 0.1),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, various possibilities#
p1.smooth.lm = p1 + stat_smooth(method = 'lm')#
p1.smooth.pois = p1 + stat_smooth(method = 'glm', family = 'poisson')#
p1.smooth.loess = p1 + stat_smooth(method = 'loess')#
#
# display the plot#
print(p1.smooth.loess)
# plot number of galls in spring 2011 ~ number of females introduced in summer 2010#
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, various possibilities#
p1.smooth.lm = p1 + stat_smooth(method = 'lm')#
p1.smooth.pois = p1 + stat_smooth(method = 'glm', family = 'poisson')#
p1.smooth.loess = p1 + stat_smooth(method = 'loess')
print(p1.smooth.loess)
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, various possibilities#
p1.smooth = p1 + stat_smooth(method = 'loess') # some methods include loess, lm, glm (family='poisson')#
#
# display the plot#
print(p1.smooth)
plot(galls2011 ~ I(females+ runif(30)), data=d)
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p1 + stat_smooth(method = 'loess')#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess')#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'darkblue', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess')#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'darkblue', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='darkblue')#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'darkgreen', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='darkgreen')#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'darkgreen', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='darkgreen')#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'darkgreen', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'lm', colour='darkgreen')#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'darkgreen', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='darkgreen')#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'darkgreen', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='darkgreen', span=0.9)#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'darkgreen', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='darkgreen', span=1)#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'darkgreen', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='darkgreen', span=0.5)#
print(p2.smooth) # display the plot
# 2. plot number of galls in spring 2011 ~ #
#		number of naturally occuring, experimentally removed 2010 galls#
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'darkgreen', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='darkgreen', span=1)#
print(p2.smooth) # display the plot
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'blue', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p1.smooth = p1 + stat_smooth(method = 'loess', span=1) #
print(p1.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'cobalt', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='darkgreen', span=1)#
print(p2.smooth) # display the plot
?col2rgb
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/3, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p2.smooth) # display the plot
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2.5, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p2.smooth) # display the plot
#		number of naturally occuring, experimentally removed 2010 galls#
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p2.smooth) # display the plot
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p1.smooth = p1 + stat_smooth(method = 'loess', colour='royalblue', span=1) #
print(p1.smooth) # display the plot#
#
# 2. plot number of galls in spring 2011 ~ #
#		number of naturally occuring, experimentally removed 2010 galls#
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p2.smooth) # display the plot
plot(galls2011 ~ I(natural.galls+ runif(30)), data=d)
plot(galls2011[d$females>0 & d$shrubdying2011==0] ~ natural.galls[d$females>0 & d$shrubdying2011==0],#
	data=d)
d
plot(galls2011[d$shrubdying2011==0] ~ females[d$shrubdying2011==0], data=d)
plot(galls2011[d$shrubdying2011==0] ~ females[d$shrubdying2011==0], data=d)
plot(galls2011[d$shrubdying2011==0] ~ females[d$shrubdying2011==0], data=d)
plot(galls2011[d$shrubdying2011==0] ~ females[d$shrubdying2011==0], data=d)
plot(galls2011[d$shrubdying2011==0] ~ females[d$shrubdying2011==0], data=d)
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
		size = 2.5) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p2.smooth) # display the plot
print(p3.smooth) # display the plot
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + #
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=.75)#
print(p3.smooth) # display the plot
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, #position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + #
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=.75)#
print(p3.smooth) # display the plot
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, #position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + #
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p3.smooth) # display the plot
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) + ylim(0,12)#
	geom_point(colour = 'royalblue', alpha = 1/2, size = 2.5) + #
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p3.smooth) # display th
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, size = 2.5) + #
	ylim(0,12) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p3.smooth) # display the plot
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, size = 2.5) + #
	scale_y_continuous(limits = c(0,12) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p3.smooth) # display the plot
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, size = 2.5) + #
	scale_y_continuous(limits = c(0,12)) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p3.smooth) # display the plot
p3.smooth = p3 + stat_smooth(method = 'lm', colour='royalblue', span=1)#
print(p3.smooth) # display the plot
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)
print(p3.smooth) # display the plot
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='s', size=1, zlab='Number of galls', xlab=
	'Previous year gall density',ylab='Number of females')
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='h', add=TRUE)
scatterplot3d(d$natural.galls, d$females, d$galls2011)
scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16)
scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=21)
scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=20)
scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16)
scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE)
?scatterplot3d
scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, type='h')
fit.plane = lm(galls2011 ~ natural.galls + females, data=d)
s3d$plane3d(fit.plane)
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, type='h')
s3d$plane3d(fit.plane)
s3d1x$plane3d(fit.plane)
s3d1$plane3d(fit.plane)
fit.pois = glm(galls2011 ~ natual.galls + females, family='poisson', data=d)
fit.pois = glm(galls2011 ~ natural.galls + females, family='poisson', data=d)
s3d1$plane3d(fit.pois)
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, type='h')
s3d1$plane3d(fit.pois)
AICtab(fit.pois, fit.plane)
fit.nbinom = mle2(galls2011 ~ dnbinom(mu = a + b * natural.galls + c * females, size = s),
	start = list(a = mean(d$galls2011), b = 0, c = 0, s = 10), data=d)
fit.nbinom
fit.nbinom = mle2(galls2011 ~ dnbinom(mu = a + b * natural.galls + c * females, size = s),
	start = list(a = mean(d$galls2011), b = 0, c = 0, s = 100), data=d)
fit.nbinom = mle2(galls2011 ~ dnbinom(mu = a , size = s),
	start = list(a = mean(d$galls2011), s = 100), data=d)
fit.nbinom
fit.nbinom = mle2(galls2011 ~ dnbinom(mu = a , size = s), #
	start = list(a = mean(d$galls2011), s = 40), data=d)
warnings()
fit.nbinom
fit.nbinom = mle2(galls2011 ~ dnbinom(mu = a , size = s), #
	start = list(a = mean(d$galls2011), s = 0.2), data=d)
fit.nbinom
fit.nbinom = mle2(galls2011 ~ dnbinom(mu = a + b * natural.galls + c * females, size = s), #
	start = list(a = mean(d$galls2011), b = 0, c = 0, s = 0.2), data=d)
warnings()
fit.nbinom = mle2(galls2011 ~ dnbinom(mu = a + b * natural.galls + c * females, size = s), #
	start = list(a = mean(d$galls2011), b = 0, c = 0, s = 0.2), data=d, method='SANN')
warnings()
fit.nbinom
s3d1$plane3d(fit.nbinom)
fit.pois
fit.pois2 = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), data=d, method='SANN')
fit.pois2
s3d1$plane3d(fit.pois2)
fit.lm = lm(galls2011 ~ natural.galls + females, data=d)
s3d1$plane3d(fit.lm)
AICtab(fit.lm, fit.pois, fit.pois2)
s3d1$plane3d(fit.pois)
# type='h' displays the height of each point#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, type='h')#
# add a regression plane#
fit.lm = lm(galls2011 ~ natural.galls + females, data=d)#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), data=d, method='SANN')#
s3d1$plane3d(fit.pois)#
s3d1$plane3d(fit.lm)
# type='h' displays the height of each point#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, type='h')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), data=d)#
s3d1$plane3d(fit.pois)
print(p1.smooth) # display the plot
# type='h' displays the height of each point#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, type='h')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), data=d)#
s3d1$plane3d(fit.pois)
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='s', size=1, zlab='Number of galls', xlab=#
	'Previous year gall density',ylab='Number of females')#
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='h', add=TRUE)
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 't+1 galls')
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), data=d)#
s3d1$plane3d(fit.pois)
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='s', size=1, zlab='Number of galls', xlab=#
	'Previous year gall density',ylab='Number of females')#
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='h', add=TRUE)
plot3d(d$galls2011[d$females>0 & d$shrubdying2011==0] ~ d$natural.galls[d$females>0 & d$shrubdying2011==0]#
	+ d$females[d$females>0 & d$shrubdying2011==0], type='s', size=1, )
plot3d(d$galls2011[d$females>0 & d$shrubdying2011==0] ~ d$natural.galls[d$females>0 & d$shrubdying2011==0] #
	+ d$females[d$females>0 & d$shrubdying2011==0], type='h', add=TRUE)
#
#
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='s', size=1, zlab='Number of galls', xlab=#
	'Previous year gall density',ylab='Number of females')#
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='h', add=TRUE)
#
plot3d(d$galls2011[d$females>0 & d$shrubdying2011==0] ~ d$natural.galls[d$females>0 & d$shrubdying2011==0]#
	+ d$females[d$females>0 & d$shrubdying2011==0], type='s', size=1, )#
plot3d(d$galls2011[d$females>0 & d$shrubdying2011==0] ~ d$natural.galls[d$females>0 & d$shrubdying2011==0] #
	+ d$females[d$females>0 & d$shrubdying2011==0], type='h', add=TRUE)
#
plot3d(d$galls2011[d$females>0 & d$shrubdying2011==0] ~ d$natural.galls[d$females>0 & d$shrubdying2011==0]#
	+ d$females[d$females>0 & d$shrubdying2011==0], type='s', size=1, )#
plot3d(d$galls2011[d$females>0 & d$shrubdying2011==0] ~ d$natural.galls[d$females>0 & d$shrubdying2011==0] #
	+ d$females[d$females>0 & d$shrubdying2011==0], type='h', add=TRUE)
#
#
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='s', size=1, zlab='Number of galls', xlab=#
	'Previous year gall density',ylab='Number of females')#
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='h', add=TRUE)
plot3d(d$galls2011[d$females>0 & d$shrubdying2011==0] ~ d$natural.galls[d$females>0 & d$shrubdying2011==0]#
	+ d$females[d$females>0 & d$shrubdying2011==0], type='s', size=1, )#
plot3d(d$galls2011[d$females>0 & d$shrubdying2011==0] ~ d$natural.galls[d$females>0 & d$shrubdying2011==0] #
	+ d$females[d$females>0 & d$shrubdying2011==0], type='h', add=TRUE)
mf1 = mle2(d$galls2011 ~ dpois(lambda = a * d$females), data=d, start=list(a = 1/4))
mf1 = mle2(d$galls2011 ~ dpois(lambda = a * d$females), data=d, start=list(a = 1/4))#
plot(galls2011 ~ females, data=d)#
abline(mf1)#
mf2 = mle2(d$galls2011 ~ dnbinom(mu = a * d$females, size = s), start=list(a = 1/4, s = 1), data=d)#
abline(mf2, col='blue')#
mf3 = mle2(d$galls2011 ~ dnbinom(mu = a * d$females / (b + d$females), size=s), #
	start=list(a = 7, b = 2, s=1), data=d, method='SANN')#
points(x=1:16, y = coef(mf3)[1] * 1:16 / (coef(mf3)[2] + 1:16), type='l', col='red')#
#
mf4 = mle2(d$galls2011 ~ dnbinom(mu = a * (1 - exp(-b * d$females)), size=s),#
	start=list(a = 7, b = 1/4, s = 1), data=d)#
points(x=1:16, y = coef(mf4)[1] * (1 - exp(-coef(mf4)[2] * 1:16)), type='l', col='orange')#
#
mf5 = mle2(d$galls2011 ~ dnbinom(mu = exp(b * d$females), size=s), #
	start=list(b = 1, s=1), data=d)#
points(x=1:16, y = exp(coef(mf5)[1] * 1:16), type='l', col='green')#
#
mfg1 = mle2(d$galls2011 ~ dpois(lambda = a * (d$females + d$natural.galls)), data=d, #
	start=list(a = 1/4))#
abline(mfg1, lty=2)#
#
mfg2 = mle2(d$galls2011 ~ dnbinom(mu = a * (d$females + d$natural.galls), size = s), #
	start=list(a = 1/4, s = 1), data=d)#
abline(mf2, col='blue', lty=2)#
#
mg1 = mle2(d$galls2011 ~ dpois(lambda = a * (d$natural.galls+1)), data=d, #
	start=list(a = 1/4))#
abline(mfg1, lty=2)#
#
mg2 = mle2(d$galls2011 ~ dnbinom(mu = a * (1 + d$natural.galls), size = s), #
	start=list(a = 1/4, s = 1), data=d)#
abline(mf2, col='blue', lty=2)#
#
mf2.1 = mle2(d$galls2011 ~ dnbinom(mu = a * d$females + b * (psi.r+.3), size = s), #
	start=list(a = 1/4, b=1, s = 1), data=d)#
abline(mf2, col='blue')#
#
AICtab(mf1, mf2, mf3, mf4, mf5, mfg1, mfg2, mg1, mg2)
dzinbinom = function(x, mu, size, zprob) { #
	ifelse(x == 0, zprob + (1 - zprob) * dnbinom(0, mu = mu, size = size),#
		 (1 - zprob) * dnbinom(x, mu = mu, size = size))#
}
mz1 = mle2(galls2011 ~ dzinbinom(mu = a * females, size = s, zprob = zprob), #
	start = list(a = 1/4, s = 1, zprob = 0.5), data = d)
library(emdbook)
rm(dzinbinom)
ls()
library(emdbook)
mz1 = mle2(galls2011 ~ dzinbinom(mu = a * females, size = s, zprob = zprob), #
	start = list(a = 1/4, s = 1, zprob = 0.5), data = d)
warnings()
mz1
AICtab(mf1, mf2, mf3, mf4, mf5, mfg1, mfg2, mg1, mg2, mz1)
load("/Users/will/Desktop/anoles_model_choice.rda")
###        plotting VAA 2010 results         ####
### density / host-plant quality experiment  ####
#
# graphical exploration#
# plotting number of galls collected from each experimental plant #
# in the 2009-2010 density/quality experiment at Valentine.#
#
# load data, entered gall numbers on map dataframe#
d = read.csv('/Users/will/Documents/DATA/2011 DATA/field/VAA map.csv')#
#
library(ggplot2)#
library(lattice)#
library(rgl)#
library(fields)#
library(scatterplot3d)#
library(bbmle)#
library(emdbook)#
#
# plotting questions:#
#		1. should I include the 2 dying plants?#
#		2. should I include plants to which I introduced 0 females?#
#
#
## first 2-dimensional plots#
# load someone's hack to allow suppression of top and right borders#
source("/Users/will/Documents/R/ggplot2/rnc_ggplot2_border_themes.r")#
#
# 1. plot number of galls in spring 2011 ~ number of females introduced in summer 2010#
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + #
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(), # remove gridlines#
		panel.border = theme_border(c('left', 'bottom'))) # remove top and right of plot box#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p1.smooth = p1 + stat_smooth(method = 'loess', colour='royalblue', span=1) #
print(p1.smooth) # display the plot#
#
# 2. plot number of galls in spring 2011 ~ #
#		number of naturally occuring, experimentally removed 2010 galls#
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p2.smooth) # display the plot#
#
# 3. plot number of galls in spring 2011 ~ time corrected water potential#
#		d$psi.r is residuals of linear regression psi ~ time#
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, size = 2.5) + #
	scale_y_continuous(limits = c(0,12)) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p3.smooth) # display the plot#
#
#
## second 3-d plots#
#
# 1. plot galls on plants in spring 2011 ~ removed natural galls and introduced females#
# highlight.3d colors points in relation to y axis, the number of females#
# type='h' displays the height of each point#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
#
# interactive version of above plot#
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='s', size=1, zlab='Number of galls', xlab=#
	'Previous year gall density',ylab='Number of females')#
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='h', add=TRUE)
png(p3.smooth) # display the plot
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment')
load("/Users/will/Desktop/anoles_model_choice.rda")
ls()
?save
rm(list=ls())
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~rpsi.png')
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)
# Eutreta-diana-density-quality-experiment/plotting VAA 2010 results.R#
#
###        plotting VAA 2010 results         ####
### density / host-plant quality experiment  ####
#
# graphical exploration#
# plotting number of galls collected from each experimental plant #
# in the 2009-2010 density/quality experiment at Valentine.#
#
# load data, entered gall numbers on map dataframe#
d = read.csv('/Users/will/Documents/DATA/2011 DATA/field/VAA map.csv')#
#
library(ggplot2)#
library(lattice)#
library(rgl)#
library(fields)#
library(scatterplot3d)#
library(bbmle)#
library(emdbook)#
#
# plotting questions:#
#		1. should I include the 2 dying plants?#
#		2. should I include plants to which I introduced 0 females?#
#
#
## first 2-dimensional plots#
# load someone's hack to allow suppression of top and right borders#
source("/Users/will/Documents/R/ggplot2/rnc_ggplot2_border_themes.r")#
#
# 1. plot number of galls in spring 2011 ~ number of females introduced in summer 2010#
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + #
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(), # remove gridlines#
		panel.border = theme_border(c('left', 'bottom'))) # remove top and right of plot box#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p1.smooth = p1 + stat_smooth(method = 'loess', colour='royalblue', span=1) #
print(p1.smooth) # display the plot#
#
# 2. plot number of galls in spring 2011 ~ #
#		number of naturally occuring, experimentally removed 2010 galls#
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
print(p2.smooth) # display the plot#
#
# 3. plot number of galls in spring 2011 ~ time corrected water potential#
#		d$psi.r is residuals of linear regression psi ~ time#
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, size = 2.5) + #
	scale_y_continuous(limits = c(0,12)) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~rpsi.png')
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~rpsi.png')
?png
print(p3.smooth)
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, size = 2.5) + #
	scale_y_continuous(limits = c(0,12)) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)
print(p3.smooth)
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
print(p3.smooth)
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~rpsi.png')
print(p3.smooth)
dev.off()
dev.off()
tiff('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~rpsi.tiff')
print(p3.smooth)
dev.off()
dev.off()
rm(list=ls())
dev.off()
# /Users/will/Documents/Analysis repos/#
# Eutreta-diana-density-quality-experiment/plotting VAA 2010 results.R#
#
###        plotting VAA 2010 results         ####
### density / host-plant quality experiment  ####
#
# graphical exploration#
# plotting number of galls collected from each experimental plant #
# in the 2009-2010 density/quality experiment at Valentine.#
#
# load data, entered gall numbers on map dataframe#
d = read.csv('/Users/will/Documents/DATA/2011 DATA/field/VAA map.csv')#
#
library(ggplot2)#
library(lattice)#
library(rgl)#
library(fields)#
library(scatterplot3d)#
library(bbmle)#
library(emdbook)#
#
# plotting questions:#
#		1. should I include the 2 dying plants?#
#		2. should I include plants to which I introduced 0 females?#
#
#
## first 2-dimensional plots#
# load someone's hack to allow suppression of top and right borders#
source("/Users/will/Documents/R/ggplot2/rnc_ggplot2_border_themes.r")#
#
# 1. plot number of galls in spring 2011 ~ number of females introduced in summer 2010#
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + #
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(), # remove gridlines#
		panel.border = theme_border(c('left', 'bottom'))) # remove top and right of plot box#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p1.smooth = p1 + stat_smooth(method = 'loess', colour='royalblue', span=1) #
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/#
	galls~females.png')#
print(p1.smooth)#
dev.off()#
#
# 2. plot number of galls in spring 2011 ~ #
#		number of naturally occuring, experimentally removed 2010 galls#
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
#
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/#
	galls~naturalgalls.png')#
print(p2.smooth)#
dev.off()#
#
# 3. plot number of galls in spring 2011 ~ time corrected water potential#
#		d$psi.r is residuals of linear regression psi ~ time#
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, size = 2.5) + #
	scale_y_continuous(limits = c(0,12)) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/#
	galls~rpsi.png')#
print(p3.smooth)#
dev.off()
# /Users/will/Documents/Analysis repos/#
# Eutreta-diana-density-quality-experiment/plotting VAA 2010 results.R#
#
###        plotting VAA 2010 results         ####
### density / host-plant quality experiment  ####
#
# graphical exploration#
# plotting number of galls collected from each experimental plant #
# in the 2009-2010 density/quality experiment at Valentine.#
#
# load data, entered gall numbers on map dataframe#
d = read.csv('/Users/will/Documents/DATA/2011 DATA/field/VAA map.csv')#
#
library(ggplot2)#
library(lattice)#
library(rgl)#
library(fields)#
library(scatterplot3d)#
library(bbmle)#
library(emdbook)#
#
# plotting questions:#
#		1. should I include the 2 dying plants?#
#		2. should I include plants to which I introduced 0 females?#
#
#
## first 2-dimensional plots#
# load someone's hack to allow suppression of top and right borders#
source("/Users/will/Documents/R/ggplot2/rnc_ggplot2_border_themes.r")#
#
# 1. plot number of galls in spring 2011 ~ number of females introduced in summer 2010#
p1 = ggplot(data = d, aes(x = females, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + #
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(), # remove gridlines#
		panel.border = theme_border(c('left', 'bottom'))) # remove top and right of plot box#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p1.smooth = p1 + stat_smooth(method = 'loess', colour='royalblue', span=1) #
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~females.png')#
print(p1.smooth)#
dev.off()#
#
# 2. plot number of galls in spring 2011 ~ #
#		number of naturally occuring, experimentally removed 2010 galls#
p2 = ggplot(data = d, aes(x = natural.galls, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, position = position_jitter(w = 0.15, h = 0.15),#
	size = 2.5) + theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p2.smooth = p2 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
#
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~naturalgalls.png')#
print(p2.smooth)#
dev.off()#
#
# 3. plot number of galls in spring 2011 ~ time corrected water potential#
#		d$psi.r is residuals of linear regression psi ~ time#
p3 = ggplot(data = d, aes(x = psi.r, y = galls2011)) +#
	geom_point(colour = 'royalblue', alpha = 1/2, size = 2.5) + #
	scale_y_continuous(limits = c(0,12)) +#
	theme_bw() + #
	opts( panel.grid.minor = theme_blank(), panel.grid.major = theme_blank(),#
		panel.border = theme_border(c('left', 'bottom')))#
		#
# now add a smoother with confidence interval, methods include loess, lm, glm (family='poisson')#
p3.smooth = p3 + stat_smooth(method = 'loess', colour='royalblue', span=1)#
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~rpsi.png')#
print(p3.smooth)#
dev.off()#
#
## second 3-d plots#
#
# 1. plot galls on plants in spring 2011 ~ removed natural galls and introduced females#
# highlight.3d colors points in relation to y axis, the number of females#
# type='h' displays the height of each point#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
#
# 2. interactive version of above plot#
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='s', size=1, zlab='Number of galls', xlab=#
	'Previous year gall density',ylab='Number of females')#
plot3d(d$galls2011 ~ d$natural.galls + d$females, type='h', add=TRUE)
pdf('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~naturalgalls.pdf')#
print(p2.smooth)#
dev.off()
#
ggsave('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/#
	galls~naturalgalls2.pdf', plot = p2.smooth)
?ggsave
pdf('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/3d-VAA2010.pdf')#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
dev.off()
ggsave('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~naturalgalls2.pdf', plot = p2.smooth)
ggsave('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/galls~naturalgalls2.pdf', plot = p2.smooth, width=4, height=4)
?pdf
pdf('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/3d-VAA2010.pdf',#
	width = 4, height = 4)#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
dev.off()
pdf('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/3d-VAA2010.pdf',#
	width = 5, height = 5)#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
dev.off()
?scatterplot3d
?pdf
pdf('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/3d-VAA2010.pdf',#
	width = 5, height = 5, type='cairo')#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
dev.off()
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/3d-VAA2010.png',#
	width = 5, height = 5)#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
dev.off()
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/3d-VAA2010.png',#
	width = 6, height = 6)#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
dev.off()
scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/3d-VAA2010.png',#
	width = 7, height = 7)#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
dev.off()
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/3d-VAA2010.png',#
	width = 15, height = 15)#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
dev.off()
# 1. plot galls on plants in spring 2011 ~ removed natural galls and introduced females#
# highlight.3d colors points in relation to y axis, the number of females#
# type='h' displays the height of each point#
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/3d-VAA2010.png')#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
dev.off()
dev.off()
# highlight.3d colors points in relation to y axis, the number of females#
# type='h' displays the height of each point#
png('/Users/will/Documents/Analysis repos/Eutreta-diana-density-quality-experiment/3d-VAA2010.png')#
s3d1 = scatterplot3d(d$natural.galls, d$females, d$galls2011, pch=16, highlight.3d=TRUE, #
	type='h', zlab = 'Galls in year t+1', ylab = 'Introduced females', #
	xlab = 'Galls in year t')#
# add a regression plane#
fit.pois = mle2(galls2011 ~ dpois(lambda = a + b * natural.galls + c * females), #
	start = list(a = mean(d$galls2011), b = 0, c = 0), method = 'SANN', data=d)#
s3d1$plane3d(fit.pois)#
dev.off()
